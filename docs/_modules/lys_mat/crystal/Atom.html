

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lys_mat.crystal.Atom &mdash; lys_mat  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            lys_mat
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">lys_mat</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">lys_mat.crystal.Atom</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for lys_mat.crystal.Atom</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">sympyFuncs</span> <span class="k">as</span> <span class="n">spf</span>


<div class="viewcode-block" id="Atom">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Atom</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Atom class is a basic element class used for crystal structures.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str or int): The atomic symbol or atomic number of the atom.</span>
<span class="sd">        position (length 3 sequence of float or sympy expression, optional): The fractional coordinates of the atom in 3D space. Defaults to (0, 0, 0).</span>
<span class="sd">        U (float or 3 x 3 array like or length 6 sequence of float, optional): Atomic displacement parameter. If U is scalar, it assume that U is isotropic. If U is length 6 sequence, it gives U11, 22, 33, 12, 23, 31.</span>
<span class="sd">        occupancy (float between 0 and 1, optional): The occupancy of the atom.</span>
<span class="sd">        **kwargs: Additional keyword arguments to set attributes of the atom.</span>

<span class="sd">    Example::</span>

<span class="sd">        from lys_mat import Atom</span>
<span class="sd">        at = Atom(&quot;H&quot;, (0,0.5,0.5))</span>
<span class="sd">        print(at)     # H (Z = 1, Occupancy = 1) Pos = (0.00000, 0.50000, 0.50000)</span>

<span class="sd">        at = Atom(&quot;H&quot;, (0,0.5,0.5), U = 1, occupancy = 0.5)</span>
<span class="sd">        print(at)     # H (Z = 1, Occupancy = 0.5) Pos = (0.00000, 0.50000, 0.50000)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__numbers</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\&#39;</span><span class="s1">Rn</span><span class="se">\&#39;</span><span class="s1">: 86, </span><span class="se">\&#39;</span><span class="s1">Zr</span><span class="se">\&#39;</span><span class="s1">: 40, </span><span class="se">\&#39;</span><span class="s1">W</span><span class="se">\&#39;</span><span class="s1">: 74, </span><span class="se">\&#39;</span><span class="s1">I</span><span class="se">\&#39;</span><span class="s1">: 53, </span><span class="se">\&#39;</span><span class="s1">At</span><span class="se">\&#39;</span><span class="s1">: 85, </span><span class="se">\&#39;</span><span class="s1">B</span><span class="se">\&#39;</span><span class="s1">: 5, </span><span class="se">\&#39;</span><span class="s1">U</span><span class="se">\&#39;</span><span class="s1">: 92, </span><span class="se">\&#39;</span><span class="s1">In</span><span class="se">\&#39;</span><span class="s1">: 49, </span><span class="se">\&#39;</span><span class="s1">N</span><span class="se">\&#39;</span><span class="s1">: 7, </span><span class="se">\&#39;</span><span class="s1">Pu</span><span class="se">\&#39;</span><span class="s1">: 94, </span><span class="se">\&#39;</span><span class="s1">Si</span><span class="se">\&#39;</span><span class="s1">: 14, </span><span class="se">\&#39;</span><span class="s1">Am</span><span class="se">\&#39;</span><span class="s1">: 95, </span><span class="se">\&#39;</span><span class="s1">Sn</span><span class="se">\&#39;</span><span class="s1">: 50, </span><span class="se">\&#39;</span><span class="s1">Cf</span><span class="se">\&#39;</span><span class="s1">: 98, </span><span class="se">\&#39;</span><span class="s1">Ta</span><span class="se">\&#39;</span><span class="s1">: 73, </span><span class="se">\&#39;</span><span class="s1">P</span><span class="se">\&#39;</span><span class="s1">: 15, </span><span class="se">\&#39;</span><span class="s1">Kr</span><span class="se">\&#39;</span><span class="s1">: 36, </span><span class="se">\&#39;</span><span class="s1">C</span><span class="se">\&#39;</span><span class="s1">: 6, </span><span class="se">\&#39;</span><span class="s1">Co</span><span class="se">\&#39;</span><span class="s1">: 27, </span><span class="se">\&#39;</span><span class="s1">Nb</span><span class="se">\&#39;</span><span class="s1">: 41, </span><span class="se">\&#39;</span><span class="s1">V</span><span class="se">\&#39;</span><span class="s1">: 23, </span><span class="se">\&#39;</span><span class="s1">Sr</span><span class="se">\&#39;</span><span class="s1">: 38, </span><span class="se">\&#39;</span><span class="s1">Pt</span><span class="se">\&#39;</span><span class="s1">: 78, </span><span class="se">\&#39;</span><span class="s1">F</span><span class="se">\&#39;</span><span class="s1">: 9, </span><span class="se">\&#39;</span><span class="s1">Gd</span><span class="se">\&#39;</span><span class="s1">: 64, </span><span class="se">\&#39;</span><span class="s1">Ti</span><span class="se">\&#39;</span><span class="s1">: 22, </span><span class="se">\&#39;</span><span class="s1">K</span><span class="se">\&#39;</span><span class="s1">: 19, </span><span class="se">\&#39;</span><span class="s1">Eu</span><span class="se">\&#39;</span><span class="s1">: 63, </span><span class="se">\&#39;</span><span class="s1">Tc</span><span class="se">\&#39;</span><span class="s1">: 43, </span><span class="se">\&#39;</span><span class="s1">Rh</span><span class="se">\&#39;</span><span class="s1">: 45, </span><span class="se">\&#39;</span><span class="s1">S</span><span class="se">\&#39;</span><span class="s1">: 16, </span><span class="se">\&#39;</span><span class="s1">Ho</span><span class="se">\&#39;</span><span class="s1">: 67, </span><span class="se">\&#39;</span><span class="s1">Th</span><span class="se">\&#39;</span><span class="s1">: 90, </span><span class="se">\&#39;</span><span class="s1">Hf</span><span class="se">\&#39;</span><span class="s1">: 72, </span><span class="se">\&#39;</span><span class="s1">Ir</span><span class="se">\&#39;</span><span class="s1">: 77, </span><span class="se">\&#39;</span><span class="s1">Fe</span><span class="se">\&#39;</span><span class="s1">: 26, </span><span class="se">\&#39;</span><span class="s1">Au</span><span class="se">\&#39;</span><span class="s1">: 79, </span><span class="se">\&#39;</span><span class="s1">Tm</span><span class="se">\&#39;</span><span class="s1">: 69, </span><span class="se">\&#39;</span><span class="s1">Er</span><span class="se">\&#39;</span><span class="s1">: 68, </span><span class="se">\&#39;</span><span class="s1">Cd</span><span class="se">\&#39;</span><span class="s1">: 48, </span><span class="se">\&#39;</span><span class="s1">Cm</span><span class="se">\&#39;</span><span class="s1">: 96, </span><span class="se">\&#39;</span><span class="s1">Ru</span><span class="se">\&#39;</span><span class="s1">: 44, </span><span class="se">\&#39;</span><span class="s1">Yb</span><span class="se">\&#39;</span><span class="s1">: 70, </span><span class="se">\&#39;</span><span class="s1">Nd</span><span class="se">\&#39;</span><span class="s1">: 60, </span><span class="se">\&#39;</span><span class="s1">Pa</span><span class="se">\&#39;</span><span class="s1">: 91, </span><span class="se">\&#39;</span><span class="s1">Ga</span><span class="se">\&#39;</span><span class="s1">: 31, </span><span class="se">\&#39;</span><span class="s1">Np</span><span class="se">\&#39;</span><span class="s1">: 93, </span><span class="se">\&#39;</span><span class="s1">Al</span><span class="se">\&#39;</span><span class="s1">: 13, </span><span class="se">\&#39;</span><span class="s1">Re</span><span class="se">\&#39;</span><span class="s1">: 75, </span><span class="se">\&#39;</span><span class="s1">Pr</span><span class="se">\&#39;</span><span class="s1">: 59, </span><span class="se">\&#39;</span><span class="s1">Ra</span><span class="se">\&#39;</span><span class="s1">: 88, </span><span class="se">\&#39;</span><span class="s1">Lu</span><span class="se">\&#39;</span><span class="s1">: 71, </span><span class="se">\&#39;</span><span class="s1">Y</span><span class="se">\&#39;</span><span class="s1">: 39, </span><span class="se">\&#39;</span><span class="s1">Pm</span><span class="se">\&#39;</span><span class="s1">: 61, </span><span class="se">\&#39;</span><span class="s1">Mn</span><span class="se">\&#39;</span><span class="s1">: 25, </span><span class="se">\&#39;</span><span class="s1">Li</span><span class="se">\&#39;</span><span class="s1">: 3, </span><span class="se">\&#39;</span><span class="s1">Se</span><span class="se">\&#39;</span><span class="s1">: 34, </span><span class="se">\&#39;</span><span class="s1">Sm</span><span class="se">\&#39;</span><span class="s1">: 62, </span><span class="se">\&#39;</span><span class="s1">Ce</span><span class="se">\&#39;</span><span class="s1">: 58, </span><span class="se">\&#39;</span><span class="s1">Zn</span><span class="se">\&#39;</span><span class="s1">: 30, </span><span class="se">\&#39;</span><span class="s1">Bi</span><span class="se">\&#39;</span><span class="s1">: 83, </span><span class="se">\&#39;</span><span class="s1">Pd</span><span class="se">\&#39;</span><span class="s1">: 46, </span><span class="se">\&#39;</span><span class="s1">Ni</span><span class="se">\&#39;</span><span class="s1">: 28, </span><span class="se">\&#39;</span><span class="s1">Cs</span><span class="se">\&#39;</span><span class="s1">: 55, </span><span class="se">\&#39;</span><span class="s1">Mg</span><span class="se">\&#39;</span><span class="s1">: 12, </span><span class="se">\&#39;</span><span class="s1">Cr</span><span class="se">\&#39;</span><span class="s1">: 24, </span><span class="se">\&#39;</span><span class="s1">Dy</span><span class="se">\&#39;</span><span class="s1">: 66, </span><span class="se">\&#39;</span><span class="s1">Rb</span><span class="se">\&#39;</span><span class="s1">: 37, </span><span class="se">\&#39;</span><span class="s1">Ca</span><span class="se">\&#39;</span><span class="s1">: 20, </span><span class="se">\&#39;</span><span class="s1">Te</span><span class="se">\&#39;</span><span class="s1">: 52, </span><span class="se">\&#39;</span><span class="s1">Ar</span><span class="se">\&#39;</span><span class="s1">: 18, </span><span class="se">\&#39;</span><span class="s1">As</span><span class="se">\&#39;</span><span class="s1">: 33, </span><span class="se">\&#39;</span><span class="s1">Cu</span><span class="se">\&#39;</span><span class="s1">: 29, </span><span class="se">\&#39;</span><span class="s1">Ac</span><span class="se">\&#39;</span><span class="s1">: 89, </span><span class="se">\&#39;</span><span class="s1">Cl</span><span class="se">\&#39;</span><span class="s1">: 17, </span><span class="se">\&#39;</span><span class="s1">Ne</span><span class="se">\&#39;</span><span class="s1">: 10, </span><span class="se">\&#39;</span><span class="s1">Mo</span><span class="se">\&#39;</span><span class="s1">: 42, </span><span class="se">\&#39;</span><span class="s1">Be</span><span class="se">\&#39;</span><span class="s1">: 4, </span><span class="se">\&#39;</span><span class="s1">Sc</span><span class="se">\&#39;</span><span class="s1">: 21, </span><span class="se">\&#39;</span><span class="s1">Na</span><span class="se">\&#39;</span><span class="s1">: 11, </span><span class="se">\&#39;</span><span class="s1">Ag</span><span class="se">\&#39;</span><span class="s1">: 47, </span><span class="se">\&#39;</span><span class="s1">Xe</span><span class="se">\&#39;</span><span class="s1">: 54, </span><span class="se">\&#39;</span><span class="s1">Tb</span><span class="se">\&#39;</span><span class="s1">: 65, </span><span class="se">\&#39;</span><span class="s1">H</span><span class="se">\&#39;</span><span class="s1">: 1, </span><span class="se">\&#39;</span><span class="s1">Ge</span><span class="se">\&#39;</span><span class="s1">: 32, </span><span class="se">\&#39;</span><span class="s1">Po</span><span class="se">\&#39;</span><span class="s1">: 84, </span><span class="se">\&#39;</span><span class="s1">Br</span><span class="se">\&#39;</span><span class="s1">: 35, </span><span class="se">\&#39;</span><span class="s1">He</span><span class="se">\&#39;</span><span class="s1">: 2, </span><span class="se">\&#39;</span><span class="s1">O</span><span class="se">\&#39;</span><span class="s1">: 8, </span><span class="se">\&#39;</span><span class="s1">Tl</span><span class="se">\&#39;</span><span class="s1">: 81, </span><span class="se">\&#39;</span><span class="s1">Bk</span><span class="se">\&#39;</span><span class="s1">: 97, </span><span class="se">\&#39;</span><span class="s1">Fr</span><span class="se">\&#39;</span><span class="s1">: 87, </span><span class="se">\&#39;</span><span class="s1">Sb</span><span class="se">\&#39;</span><span class="s1">: 51, </span><span class="se">\&#39;</span><span class="s1">Pb</span><span class="se">\&#39;</span><span class="s1">: 82, </span><span class="se">\&#39;</span><span class="s1">Ba</span><span class="se">\&#39;</span><span class="s1">: 56, </span><span class="se">\&#39;</span><span class="s1">Hg</span><span class="se">\&#39;</span><span class="s1">: 80, </span><span class="se">\&#39;</span><span class="s1">La</span><span class="se">\&#39;</span><span class="s1">: 57, </span><span class="se">\&#39;</span><span class="s1">Os</span><span class="se">\&#39;</span><span class="s1">: 76, </span><span class="se">\&#39;</span><span class="s1">Void</span><span class="se">\&#39;</span><span class="s1">: 0}&#39;</span><span class="p">)</span>
    <span class="n">__masses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ac&#39;</span><span class="p">:</span> <span class="mf">227.0</span><span class="p">,</span> <span class="s1">&#39;Ar&#39;</span><span class="p">:</span> <span class="mf">39.948</span><span class="p">,</span> <span class="s1">&#39;Lr&#39;</span><span class="p">:</span> <span class="mf">262.0</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mf">30.973762</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">10.811</span><span class="p">,</span> <span class="s1">&#39;Fm&#39;</span><span class="p">:</span> <span class="mf">257.0</span><span class="p">,</span> <span class="s1">&#39;Tb&#39;</span><span class="p">:</span> <span class="mf">158.92535</span><span class="p">,</span> <span class="s1">&#39;Ir&#39;</span><span class="p">:</span> <span class="mf">192.217</span><span class="p">,</span> <span class="s1">&#39;Ho&#39;</span><span class="p">:</span> <span class="mf">164.93032</span><span class="p">,</span> <span class="s1">&#39;Tm&#39;</span><span class="p">:</span> <span class="mf">168.93421</span><span class="p">,</span> <span class="s1">&#39;Sn&#39;</span><span class="p">:</span> <span class="mf">118.71</span><span class="p">,</span> <span class="s1">&#39;Pr&#39;</span><span class="p">:</span> <span class="mf">140.90765</span><span class="p">,</span> <span class="s1">&#39;Xe&#39;</span><span class="p">:</span> <span class="mf">131.293</span><span class="p">,</span> <span class="s1">&#39;Zr&#39;</span><span class="p">:</span> <span class="mf">91.224</span><span class="p">,</span> <span class="s1">&#39;Pu&#39;</span><span class="p">:</span> <span class="mf">244.0</span><span class="p">,</span> <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="mf">4.002602</span><span class="p">,</span> <span class="s1">&#39;La&#39;</span><span class="p">:</span> <span class="mf">138.90547</span><span class="p">,</span> <span class="s1">&#39;Md&#39;</span><span class="p">:</span> <span class="mf">258.0</span><span class="p">,</span> <span class="s1">&#39;Ru&#39;</span><span class="p">:</span> <span class="mf">101.07</span><span class="p">,</span> <span class="s1">&#39;Ce&#39;</span><span class="p">:</span> <span class="mf">140.116</span><span class="p">,</span> <span class="s1">&#39;Rh&#39;</span><span class="p">:</span> <span class="mf">102.9055</span><span class="p">,</span> <span class="s1">&#39;Rn&#39;</span><span class="p">:</span> <span class="mf">220.0</span><span class="p">,</span> <span class="s1">&#39;Fe&#39;</span><span class="p">:</span> <span class="mf">55.845</span><span class="p">,</span> <span class="s1">&#39;In&#39;</span><span class="p">:</span> <span class="mf">114.818</span><span class="p">,</span> <span class="s1">&#39;Ca&#39;</span><span class="p">:</span> <span class="mf">40.078</span><span class="p">,</span> <span class="s1">&#39;Cd&#39;</span><span class="p">:</span> <span class="mf">112.411</span><span class="p">,</span> <span class="s1">&#39;Mn&#39;</span><span class="p">:</span> <span class="mf">54.938045</span><span class="p">,</span> <span class="s1">&#39;Hf&#39;</span><span class="p">:</span> <span class="mf">178.49</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mf">39.0983</span><span class="p">,</span> <span class="s1">&#39;Br&#39;</span><span class="p">:</span> <span class="mf">79.904</span><span class="p">,</span> <span class="s1">&#39;Fr&#39;</span><span class="p">:</span> <span class="mf">223.0</span><span class="p">,</span> <span class="s1">&#39;Bk&#39;</span><span class="p">:</span> <span class="mf">247.0</span><span class="p">,</span> <span class="s1">&#39;Cm&#39;</span><span class="p">:</span> <span class="mf">247.0</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="mf">50.9415</span><span class="p">,</span> <span class="s1">&#39;Ra&#39;</span><span class="p">:</span> <span class="mf">226.0</span><span class="p">,</span> <span class="s1">&#39;Cu&#39;</span><span class="p">:</span> <span class="mf">63.546</span><span class="p">,</span> <span class="s1">&#39;Nd&#39;</span><span class="p">:</span> <span class="mf">144.242</span><span class="p">,</span> <span class="s1">&#39;Yb&#39;</span><span class="p">:</span> <span class="mf">173.04</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">15.9994</span><span class="p">,</span> <span class="s1">&#39;Sm&#39;</span><span class="p">:</span> <span class="mf">150.36</span><span class="p">,</span> <span class="s1">&#39;Tc&#39;</span><span class="p">:</span> <span class="mf">98.0</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">1.00794</span><span class="p">,</span> <span class="s1">&#39;Dy&#39;</span><span class="p">:</span> <span class="mf">162.5</span><span class="p">,</span> <span class="s1">&#39;Am&#39;</span><span class="p">:</span> <span class="mf">243.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">88.90585</span><span class="p">,</span> <span class="s1">&#39;Co&#39;</span><span class="p">:</span> <span class="mf">58.933195</span><span class="p">,</span> <span class="s1">&#39;Ne&#39;</span><span class="p">:</span> <span class="mf">20.1797</span><span class="p">,</span> <span class="s1">&#39;Ni&#39;</span><span class="p">:</span> <span class="mf">58.6934</span><span class="p">,</span> <span class="s1">&#39;Kr&#39;</span><span class="p">:</span> <span class="mf">83.798</span><span class="p">,</span> <span class="s1">&#39;Th&#39;</span><span class="p">:</span> <span class="mf">232.03806</span><span class="p">,</span> <span class="s1">&#39;Er&#39;</span><span class="p">:</span> <span class="mf">167.259</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">12.0107</span><span class="p">,</span>
                <span class="s1">&#39;Np&#39;</span><span class="p">:</span> <span class="mf">237.0</span><span class="p">,</span> <span class="s1">&#39;Re&#39;</span><span class="p">:</span> <span class="mf">186.207</span><span class="p">,</span> <span class="s1">&#39;As&#39;</span><span class="p">:</span> <span class="mf">74.9216</span><span class="p">,</span> <span class="s1">&#39;Nb&#39;</span><span class="p">:</span> <span class="mf">92.90638</span><span class="p">,</span> <span class="s1">&#39;Ga&#39;</span><span class="p">:</span> <span class="mf">69.723</span><span class="p">,</span> <span class="s1">&#39;Po&#39;</span><span class="p">:</span> <span class="mf">210.0</span><span class="p">,</span> <span class="s1">&#39;Cs&#39;</span><span class="p">:</span> <span class="mf">132.9054519</span><span class="p">,</span> <span class="s1">&#39;Gd&#39;</span><span class="p">:</span> <span class="mf">157.25</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mf">14.0067</span><span class="p">,</span> <span class="s1">&#39;Sb&#39;</span><span class="p">:</span> <span class="mf">121.76</span><span class="p">,</span> <span class="s1">&#39;Se&#39;</span><span class="p">:</span> <span class="mf">78.96</span><span class="p">,</span> <span class="s1">&#39;Lu&#39;</span><span class="p">:</span> <span class="mf">174.967</span><span class="p">,</span> <span class="s1">&#39;Ag&#39;</span><span class="p">:</span> <span class="mf">107.8682</span><span class="p">,</span> <span class="s1">&#39;At&#39;</span><span class="p">:</span> <span class="mf">210.0</span><span class="p">,</span> <span class="s1">&#39;Zn&#39;</span><span class="p">:</span> <span class="mf">65.409</span><span class="p">,</span> <span class="s1">&#39;Es&#39;</span><span class="p">:</span> <span class="mf">252.0</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">32.065</span><span class="p">,</span> <span class="s1">&#39;Li&#39;</span><span class="p">:</span> <span class="mf">6.941</span><span class="p">,</span> <span class="s1">&#39;Be&#39;</span><span class="p">:</span> <span class="mf">9.012182</span><span class="p">,</span> <span class="s1">&#39;Pa&#39;</span><span class="p">:</span> <span class="mf">231.03588</span><span class="p">,</span> <span class="s1">&#39;Rb&#39;</span><span class="p">:</span> <span class="mf">85.4678</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="mf">183.84</span><span class="p">,</span> <span class="s1">&#39;Pt&#39;</span><span class="p">:</span> <span class="mf">195.084</span><span class="p">,</span> <span class="s1">&#39;Hg&#39;</span><span class="p">:</span> <span class="mf">200.59</span><span class="p">,</span> <span class="s1">&#39;Ti&#39;</span><span class="p">:</span> <span class="mf">47.867</span><span class="p">,</span> <span class="s1">&#39;Eu&#39;</span><span class="p">:</span> <span class="mf">151.964</span><span class="p">,</span> <span class="s1">&#39;Si&#39;</span><span class="p">:</span> <span class="mf">28.0855</span><span class="p">,</span> <span class="s1">&#39;Bi&#39;</span><span class="p">:</span> <span class="mf">208.9804</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">:</span> <span class="mf">26.9815386</span><span class="p">,</span> <span class="s1">&#39;Sc&#39;</span><span class="p">:</span> <span class="mf">44.955912</span><span class="p">,</span> <span class="s1">&#39;Cf&#39;</span><span class="p">:</span> <span class="mf">251.0</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">18.9984032</span><span class="p">,</span> <span class="s1">&#39;Ge&#39;</span><span class="p">:</span> <span class="mf">72.64</span><span class="p">,</span> <span class="s1">&#39;Au&#39;</span><span class="p">:</span> <span class="mf">196.966569</span><span class="p">,</span> <span class="s1">&#39;Ta&#39;</span><span class="p">:</span> <span class="mf">180.94788</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="mf">238.02891</span><span class="p">,</span> <span class="s1">&#39;Te&#39;</span><span class="p">:</span> <span class="mf">127.6</span><span class="p">,</span> <span class="s1">&#39;Tl&#39;</span><span class="p">:</span> <span class="mf">204.3833</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">:</span> <span class="mf">35.453</span><span class="p">,</span> <span class="s1">&#39;Mg&#39;</span><span class="p">:</span> <span class="mf">24.305</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">:</span> <span class="mf">259.0</span><span class="p">,</span> <span class="s1">&#39;Sr&#39;</span><span class="p">:</span> <span class="mf">87.62</span><span class="p">,</span> <span class="s1">&#39;Cr&#39;</span><span class="p">:</span> <span class="mf">51.9961</span><span class="p">,</span> <span class="s1">&#39;Pb&#39;</span><span class="p">:</span> <span class="mf">207.2</span><span class="p">,</span> <span class="s1">&#39;Pm&#39;</span><span class="p">:</span> <span class="mf">145.0</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">:</span> <span class="mf">95.94</span><span class="p">,</span> <span class="s1">&#39;Os&#39;</span><span class="p">:</span> <span class="mf">190.23</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mf">126.90447</span><span class="p">,</span> <span class="s1">&#39;Pd&#39;</span><span class="p">:</span> <span class="mf">106.42</span><span class="p">,</span> <span class="s1">&#39;Na&#39;</span><span class="p">:</span> <span class="mf">22.98976928</span><span class="p">,</span> <span class="s1">&#39;Ba&#39;</span><span class="p">:</span> <span class="mf">137.327</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">U</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">occu</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomicName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">occu</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;[Atom] Initializing Ocuupancy by &#39;occu&#39; is deprecated. Use &#39;occupancy&#39; instead.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span> <span class="o">=</span> <span class="n">occu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Uani</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__loadU</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

        <span class="c1"># Set all keyward arguments as attributes.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<div class="viewcode-block" id="Atom.duplicate">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.duplicate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">duplicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a deep copy of the current object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Atom: A deep copy of the current object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the atomic number of the current object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The atomic number of the current object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAtomicNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">)</span>

    <span class="c1"># Sympy related methods</span>
<div class="viewcode-block" id="Atom.subs">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.subs">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">subs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Substitute the given arguments and keyword arguments in the sympy objects of the current object.</span>

<span class="sd">        Args:</span>
<span class="sd">            args: see example.</span>
<span class="sd">            kwargs: see example.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Atom: A new Atom object with the substituted sympy objects.</span>

<span class="sd">        Examples::</span>

<span class="sd">            import sympy as sp</span>
<span class="sd">            from lys_mat import Atom</span>

<span class="sd">            x,y,z = sp.symbols(&quot;x,y,z&quot;)</span>
<span class="sd">            at = Atom(&quot;H&quot;, (x, y, z))</span>

<span class="sd">            # There are many ways to substitute.</span>
<span class="sd">            at.subs(x, 0.3)                 # H (Z = 1) Pos = (0.3, y, z)</span>
<span class="sd">            at.subs({x:0.2, y:0.3, z:0.4})  # H (Z = 1) Pos = (0.2, 0.3, 0.4)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">spf</span><span class="o">.</span><span class="n">isSympyObject</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">spf</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">res</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">free_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the set of free symbols in the current object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            set: The set of free symbols in the current object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">spf</span><span class="o">.</span><span class="n">free_symbols</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">spf</span><span class="o">.</span><span class="n">isSympyObject</span><span class="p">(</span><span class="n">val</span><span class="p">)]</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">res</span><span class="p">)</span>

    <span class="c1"># static methods</span>
<div class="viewcode-block" id="Atom.getAtomicNumber">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.getAtomicNumber">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getAtomicNumber</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the atomic number of an element given its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The atomic number of the element.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__numbers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span></div>


<div class="viewcode-block" id="Atom.getAtomicName">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.getAtomicName">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getAtomicName</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the name of an element given its atomic number.</span>

<span class="sd">        Args:</span>
<span class="sd">            number (int): The atomic number of the element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The name of the element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__numbers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="n">number</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">key</span></div>


<div class="viewcode-block" id="Atom.getAtomicMass">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.getAtomicMass">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">getAtomicMass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the atomic mass of an element given its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The atomic mass of the element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__masses</span><span class="p">[</span><span class="n">name</span><span class="p">]</span></div>


<div class="viewcode-block" id="Atom.saveAsDictionary">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.saveAsDictionary">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">saveAsDictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># save as string like</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a dictionary representation of the `Atom` object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary containing the all information of the atom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Element&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">):</span>
            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;Position_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="s2">&quot;element&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span></div>


<div class="viewcode-block" id="Atom.loadFromDictionary">
<a class="viewcode-back" href="../../../lys_mat_/Atom.html#lys_mat.crystal.Atom.Atom.loadFromDictionary">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loadFromDictionary</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load an `Atom` object from a dictionary representation, which is generated by `saveAsDictionary`.</span>

<span class="sd">        Args:</span>
<span class="sd">            d (dict): A dictionary generated by `saveAsDictionary`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Atom: An `Atom` object with the loaded data.</span>

<span class="sd">        Example::</span>

<span class="sd">            at = Atom(&quot;H&quot;, (0, 0.5, 0.5))</span>
<span class="sd">            d = at.saveAsDictionary()</span>

<span class="sd">            at_load = Atom.loadFromDictionary(d)</span>
<span class="sd">            type(at_load)  # Atom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="s2">&quot;Position_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_deparse</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;Position_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
            <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Element&quot;</span><span class="p">,</span> <span class="s2">&quot;Position_0&quot;</span><span class="p">,</span> <span class="s2">&quot;Position_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Position_2&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_deparse</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Atom</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">+</span> <span class="s2">&quot; (Z = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;occupancy&quot;</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot;, Occupancy = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">if</span> <span class="n">spf</span><span class="o">.</span><span class="n">isSympyObject</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot; Pos = (</span><span class="si">{:}</span><span class="s2">, </span><span class="si">{:}</span><span class="s2">, </span><span class="si">{:}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot; Pos = (</span><span class="si">{:.5f}</span><span class="s2">, </span><span class="si">{:.5f}</span><span class="s2">, </span><span class="si">{:.5f}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;spin&quot;</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="s2">&quot; Spin = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spin</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mu_B&quot;</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;[String]&quot;</span> <span class="o">+</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">_parse</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">spf</span><span class="o">.</span><span class="n">isSympyObject</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_deparse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;[String]&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">sp</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">_deparse</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__loadU</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">U</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">):</span>
            <span class="n">Uani</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>  <span class="c1"># Uaniso-&gt;11,22,33,12,23,13</span>
            <span class="n">Uani</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span> <span class="p">[</span><span class="n">U</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span> <span class="p">[</span><span class="n">U</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Uani</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Uani</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;occupancy&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;occupancy&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Occupancy&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Position&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Element&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hidenori Tsuji.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>